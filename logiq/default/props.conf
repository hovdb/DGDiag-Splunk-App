[default]
[DIAG06]
KV_MODE = none
DATETIME_CONFIG = /etc/apps/logiq/default/sysinfodatetime.xml
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
category = Custom
disabled = false
pulldown_type = true
BREAK_ONLY_BEFORE_DATE = 
SHOULD_LINEMERGE = false
EXTRACT-systemUptime = ^Uptime:\s+(?P<systemUptime>.+)
EXTRACT-kernelVersion = ^Kernel version:\s+(?P<kernelVersion>.+)
EXTRACT-productVersion = ^Product version:\s+(?P<productVersion>.+)
EXTRACT-systemBuild = ^Kernel build number:\s+(?P<systemBuild>.+)

[DIAG07]
DATETIME_CONFIG = CURRENT
category = Custom
description = Digital Guardian Diagnostic Hardware Information Log
disabled = false
TRANSFORMS-null = diag07
BREAK_ONLY_BEFORE = ^START
LINE_BREAKER = ^START
SHOULD_LINEMERGE = true
NO_BINARY_CHECK = true
pulldown_type = true
REPORT-fields = fields

[DIAG12]
DATETIME_CONFIG = CURRENT
LINE_BREAKER = ^\w+
BREAK_ONLY_BEFORE = ^\w+
NO_BINARY_CHECK = true
category = Custom
description = DIAG12-TASKLIST
disabled = false
pulldown_type = true
EXTRACT-process,pid,dll = ^(?P<process>[^ ]+)\s+(?P<PID>\d+)\s+(?P<dll>.*)

[DIAG14]
DATETIME_CONFIG = CURRENT
FIELD_DELIMITER = tab
INDEXED_EXTRACTIONS = csv
KV_MODE = none
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
category = Custom
description = Digital Guardian Log DIAG14
disabled = false
pulldown_type = true

[config_xml]
DATETIME_CONFIG = CURRENT
LINE_BREAKER = (>[\r\n\t ]*<(?!/))
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
category = Custom
description = break every line for config.xml
disabled = false
pulldown_type = true
BREAK_ONLY_BEFORE_DATE = 
EXTRACT-Config_Tag,Config_Attrib,Config_Value = ^(?P<Config_Tag>[^\t >]+)[\t ]*(?P<Config_Attrib>[^>]*)>(?P<Config_Value>[^<]*)

[dglog]
KV_MODE = none
DATETIME_CONFIG = 
TIME_FORMAT = %Y/%m/%d %H:%M:%S.%3N
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
category = Custom
description = Digital Guardian dg.log
disabled = false
pulldown_type = true
SHOULD_LINEMERGE = false
EXTRACT-processFlags = =\[(?P<processFlags>[A-Z+]+?)\+?]
EXTRACT-EventType = ^[^\[\n]*\-\-\s+\[(?P<EventType>[^]]+)\]
EXTRACT-dglog : EXTRACT-diskspace = ^[^>\n]*>\s+(?P<diskspace>\d+)
EXTRACT-PID,process,propagatedFrom = ^[^\[\n]*\-\-\s.*\spid=(?P<PID>\d+)\s\[(?P<process>[^\]]+)]=\[[A-Z+]+]\spropagatedFrom=\[(?P<propagatedFrom>[^\]]*)]
EXTRACT-PID,process_path,process = ^[^\[\n]*\-\-\s.*\sPID[=\s](?P<PID>\d+)\s"(?P<process_path>(?:[^"]*\\)?(?P<process>[^\\"]{0,14}).*?)"
EXTRACT-entity,frequency = ^(?:[^\[\n].*)\s+Entity\s+(?P<entity>[^ ]+)\s+(?P<frequency>\d+)
EXTRACT-excluded,not_excluded = ^[^\(\n]*ms\s\((?P<excluded>.+)\)|(?P<not_excluded>\(\))
EXTRACT-DGCI_DoContentInspection,start_end,file = ^[^\[\n]*\-\-\s\[_DGCI_DoContentInspection\].+(?P<DGCI_DoContentInspection>\[[^\]]+)\]\s+(?P<start_end>\w+)[^\[]+\[(?P<File>[^\]]+)
EXTRACT-dglog : EXTRACT-ruleVarAction,ruleVarName,ruleVarType,ruleVarScope = ^.*RuleVariables:\s+(?!SET)(?P<ruleVarAction>\w+):.*"(?P<ruleVarName>[^"]*)"\s+type="(?P<ruleVarType>[^"]*)"\s+scope="(?P<ruleVarScope>[^"]*)"
EXTRACT-dglog : EXTRACT-ruleVarAction,ruleVarName,ruleVarType,ruleVarScope,ruleVarValue = ^.*RuleVariables:\s+(?=SET)(?P<ruleVarAction>\w+):.*"(?P<ruleVarName>[^"]*)"\s+type="(?P<ruleVarType>[^"]*)"\s+scope="(?P<ruleVarScope>[^"]*)"\s+value="(?P<ruleVarValue>[^"]*)"
EXTRACT-dglog : EXTRACT-ruleVarAction,ruleVarName,ruleVarType,ruleVarScope,ruleVarCount = ^.*RuleVariables:\s+(?=SET)(?P<ruleVarAction>\w+):.*"(?P<ruleVarName>[^"]*)"\s+type="(?P<ruleVarType>[^"]*)"\s+scope="(?P<ruleVarScope>[^"]*)"\s+array cnt=\((?P<ruleVarCount>\d+)\)
EXTRACT-dglog : EXTRACT-ruleVarName,ruleVarType,ruleVarIndex = ^.*RuleVariables:\s+(?P<ruleVarType>[^\s]+)\s+"(?P<ruleVarName>[^"]*)"\s+value\[(?P<ruleVarIndex>\d+)]="(?P<ruleVarValue>[^"]*)"
EXTRACT-EventType,cacheAction,PID,process,parent_PID,parent_process,processGUID,parentGUID = ^[^\[\n]*--\s+PROC_ENTRY:\s+\[(?P<EventType>[^\]]+)\]\s+(?P<cacheAction>\w+\s+\w+).*[^\[]\[(?P<PID>\d+):(?P<process>[^\]]+)[^ \n]* Parent\[(?P<parent_PID>[^\]]+?)(?::(?P<parent_process>[^\]]+))?].*?\s+Code={(?P<processGUID>[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12})}.*?\s+ParentCode={(?P<parentGUID>[A-F0-9]{8}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{4}-[A-F0-9]{12})}
EVAL-flags_sorted = mvjoin(mvsort(split(processFlags, "+")), "+")
EVAL-ruleVarAction = if(isnull(ruleVarAction),if(isnull(ruleVarName),null(),if(isnull(ruleVarIndex),null(),"SET")),ruleVarAction)
EXTRACT-logFileName = ^[^\[\n]*\-\-\s\[\S+\]\s+Opened log file:\s+(?P<logFileName>.*)$
EXTRACT-EventType,eventAction,actionTarget,eventSrcPath,eventDstPath,elapsedMS = ^[^\[\n]*--\s+(?P<EventType>.+)\s+action=(?P<eventAction>[^,]+),\s+target=(?<actionTarget>[^,]+),\s+src=(?P<eventSrcPath>[^,]*),\s+dst=(?P<eventDstPath>.*)\s\[.*?\]\s*-\s[\S]+(?:\s+=\s+(?P<elapsedMS>\d+(?:\.\d+)?)\sms)?
EXTRACT-EventType,cacheAction,PID,process,parent_PID,parent_process = ^[^\[\n]*--\s+PROC_ENTRY:\s+\[(?P<EventType>[^\]]+)\]\s+(?P<cacheAction>\w+\s+\w+).*[^\[]\[(?P<PID>\d+):(?P<process>[^\]]+)[^ \n]* Parent\[(?P<parent_PID>[^\]]+?)(?::(?P<parent_process>[^\]]+))?].*?processFlags=\[[^\]]+\]$
EXTRACT-dglogN = ^.*--\s\[Cassini]\s(?P<logLevel>[IWEF])(?P<logLevelNumber>\d+)[^]]+]\s(?P<connectionID>\d+)\/(?P<requestID>(?:\d+|\*))\s-\s(?P<log>.*)

[dgwip]
DATETIME_CONFIG = 
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
category = Custom
description = Digital Guardian LogIQ
pulldown_type = true
EXTRACT-dgwip = ^.*(?P<skip>SKIP\s+candidate).*\[(?P<process>\w+).*(?P<method>(GET|PUT|POST|DELETE|PATCH|OPTIONS))\s+(?P<protocol>\w+)\s+\S+\s+(?P<url>[^ ]+)\s+\d+\s+(?P<status>\d+)
EXTRACT-dgwipN = ^(?P<logLevel>[IWEF])(?P<logLevelNumber>\d+)[^]]+]\s(?P<connectionID>\d+)\/(?P<requestID>(?:\d+|\*))\s-\s(?P<log>.*)
BREAK_ONLY_BEFORE_DATE = 
KV_MODE = none
disabled = false

[diag10]
DATETIME_CONFIG = 
FIELD_DELIMITER = tab
HEADER_FIELD_DELIMITER = tab
INDEXED_EXTRACTIONS = tsv
KV_MODE = none
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
category = Custom
description = Tab-separated value format. Set header and other settings in "Delimited Settings"
disabled = false
pulldown_type = true

[prcsflgs]
DATETIME_CONFIG = CURRENT
INDEXED_EXTRACTIONS = csv
TRANSFORMS-null = prcsflgs
LINE_BREAKER = ([\r\n]+)
NO_BINARY_CHECK = true
SHOULD_LINEMERGE = false
description = Digital Guardian Process Flags
category = Custom
disabled = false
pulldown_type = true
EXTRACT-process,processFlags,company = ^(?P<process>[^,]+)[^,\n]*,(?P<processFlags>[^,]+)
EXTRACT-company = ^([^,]+),([^,]+),,(?P<company>.+)

